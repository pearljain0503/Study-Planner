<!doctype html>
<html lang="en">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title>Focus Planner â€” StudyFlow</title>

Â  Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

Â  <style>
Â  Â  /* Theme variables (renamed from pastel for clarity) */
Â  Â  :root{
Â  Â  Â  --bg: #f6f9fb;
Â  Â  Â  --bg-2: #f2f6f8;
Â  Â  Â  --card: #ffffff;
Â  Â  Â  --text: #24303b;
Â  Â  Â  --muted: #64707b;
Â  Â  Â  --accent: #9ad3c7; Â  /* teal */
Â  Â  Â  --accent-2: #ffd5c2; /* peach */
Â  Â  Â  --accent-3: #c7d2ff; /* lavender */
Â  Â  Â  --glass: rgba(255,255,255,0.6);
Â  Â  Â  --border: rgba(36,48,59,0.06);
Â  Â  Â  --success: #A8E6CF;
Â  Â  Â  --warn: #FFD3B6;
Â  Â  Â  --danger: #ff6b6b;
Â  Â  }
Â  Â  *{box-sizing:border-box}
Â  Â  html,body{height:100%}
Â  Â  body{
Â  Â  Â  margin:0;
Â  Â  Â  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
Â  Â  Â  background: linear-gradient(180deg, var(--bg), var(--bg-2));
Â  Â  Â  color:var(--text);
Â  Â  Â  -webkit-font-smoothing:antialiased;
Â  Â  Â  -moz-osx-font-smoothing:grayscale;
Â  Â  Â  min-height:100vh;
Â  Â  Â  padding:18px;
Â  Â  }

Â  Â  /* Container */
Â  Â  .container{max-width:1200px;margin:0 auto;padding:18px;}

Â  Â  header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
Â  Â  .brand{display:flex;align-items:center;gap:12px}
Â  Â  .logo{
Â  Â  Â  width:56px;height:56px;border-radius:12px;
Â  Â  Â  background:linear-gradient(135deg,var(--accent),var(--accent-3));
Â  Â  Â  display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;
Â  Â  Â  box-shadow:0 8px 20px rgba(65,105,85,0.08);
Â  Â  Â  font-family:monospace;
Â  Â  Â  font-size:18px;
Â  Â  }
Â  Â  h1{margin:0;font-size:20px}
Â  Â  .subtitle{color:var(--muted);font-size:13px;margin-top:4px}

Â  Â  nav.topnav{display:flex;align-items:center;gap:8px;padding:8px;border-radius:999px;background:transparent}
Â  Â  nav.topnav a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:8px;font-weight:600;font-size:14px}
Â  Â  nav.topnav a.active{color:var(--text);background:linear-gradient(90deg, rgba(154,211,199,0.25), rgba(199,210,255,0.15));box-shadow:0 6px 18px rgba(60,90,80,0.03)}

Â  Â  .layout{display:grid;grid-template-columns:320px 1fr;gap:20px}
Â  Â  .side{background:var(--card);padding:16px;border-radius:14px;border:1px solid var(--border);box-shadow:0 6px 18px rgba(40,50,60,0.03)}
Â  Â  .main{min-height:60vh}

Â  Â  .card{background:var(--card);padding:18px;border-radius:12px;border:1px solid var(--border);margin-bottom:16px;box-shadow:0 6px 18px rgba(40,50,60,0.02)}
Â  Â  .stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
Â  Â  .stat{padding:16px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.6), transparent);border:1px solid rgba(36,48,59,0.04)}
Â  Â  .stat h3{margin:0;font-size:13px}
Â  Â  .stat .big{font-size:22px;color:var(--text);font-weight:800;margin-top:6px}

Â  Â  /* Calendar */
Â  Â  .calendar{width:100%;background:transparent;padding:8px;border-radius:10px}
Â  Â  .cal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
Â  Â  .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
Â  Â  .day{padding:10px;border-radius:10px;text-align:center;font-size:14px;color:var(--muted);background:transparent;cursor:pointer;transition:background 0.1s}
Â  Â  .day:hover{background:var(--bg-2)}
Â  Â  .day.dimmed{opacity:0.4;cursor:default;background:transparent!important;}
Â  Â  .day.today{background:linear-gradient(180deg,var(--accent),var(--accent-3));color:#fff;font-weight:700;box-shadow:0 6px 18px rgba(154,211,199,0.12)}
Â  Â  .day.has-event{position:relative}
Â  Â  .day.has-event::after{content:'';position:absolute;left:50%;transform:translateX(-50%);bottom:6px;width:8px;height:8px;border-radius:50%;background:var(--accent-2)}
Â  Â  .selected-outline{outline:3px solid rgba(154,211,199,0.36);border-radius:10px}
Â  Â  .weekday-label{padding:10px;text-align:center;font-size:12px;font-weight:600;color:var(--text)}

Â  Â  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
Â  Â  input,textarea,select,button{font-family:inherit}
Â  Â  input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text)}
Â  Â  .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
Â  Â  .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-3));color:#fff}
Â  Â  .btn-ghost{background:transparent;border:1px solid var(--border);color:var(--text)}

Â  Â  .timer-large{font-size:44px;font-weight:800;color:var(--accent-2);text-align:center}
Â  Â  .tm-controls{display:flex;gap:12px;justify-content:center;margin-top:8px}

Â  Â  .chart-wrap{padding:12px;background:transparent;border-radius:10px;border:1px dashed rgba(36,48,59,0.03)}

Â  Â  footer{color:var(--muted);font-size:13px;margin-top:18px;text-align:center}

Â  Â  .badge{padding:6px 8px;border-radius:8px;background:linear-gradient(90deg, rgba(199,210,255,0.35), rgba(154,211,199,0.12));font-weight:700;color:var(--text);font-size:12px}

Â  Â  .events-list .event{padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.8), transparent);margin-bottom:8px;border:1px solid rgba(36,48,59,0.04)}
Â  Â  .trash{background:transparent;border:0;color:var(--danger);cursor:pointer;font-size:16px}

Â  Â  .quote{font-style:italic;color:var(--muted);font-size:14px;padding:8px;border-radius:8px;background:linear-gradient(90deg, rgba(199,210,255,0.12), rgba(154,211,199,0.06));margin-bottom:8px}

Â  Â  /* Login/Signup screen */
Â  Â  #login-view{
Â  Â  Â  position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;
Â  Â  Â  background:linear-gradient(180deg, var(--accent), var(--accent-3));
Â  Â  Â  display:flex;align-items:center;justify-content:center;
Â  Â  }
Â  Â  #login-box{
Â  Â  Â  background:var(--card);padding:30px;border-radius:16px;width:360px;
Â  Â  Â  text-align:center;box-shadow:0 10px 30px rgba(40,50,60,0.1);
Â  Â  }
Â  Â  #login-box h2{margin-top:0;color:var(--text)}
Â  Â  #login-box input{margin-bottom:15px;text-align:center;}
Â  Â  #login-box .btn-primary{width:100%;margin-top:10px;}
Â  Â  .login-logo{
Â  Â  Â  width:60px;height:60px;border-radius:12px;
Â  Â  Â  background:linear-gradient(135deg,var(--accent),var(--accent-3));
Â  Â  Â  display:inline-flex;align-items:center;justify-content:center;color:#fff;font-weight:800;
Â  Â  Â  font-family:monospace;font-size:20px;margin-bottom:15px;
Â  Â  }
Â  Â  

Â  Â  /* Responsive */
Â  Â  @media (max-width:1000px){
Â  Â  Â  .layout{grid-template-columns:1fr; }
Â  Â  Â  .stats-grid{grid-template-columns:repeat(2,1fr)}
Â  Â  Â  .logo{width:48px;height:48px}
Â  Â  Â  .brand h1{font-size:18px}
Â  Â  }
Â  Â  @media (max-width:600px){
Â  Â  Â  .stats-grid{grid-template-columns:repeat(1,1fr)}
Â  Â  Â  header{flex-direction:column;align-items:flex-start;gap:12px}
Â  Â  Â  .tm-controls{flex-wrap:wrap}
Â  Â  Â  body{padding:10px}
Â  Â  }
Â  </style>
</head>
<body>
Â  Â  <div id="login-view">
Â  Â  <div id="login-box">
Â  Â  Â  <div class="login-logo">SF</div>
Â  Â  Â  <h2>Welcome to StudyFlow</h2>
Â  Â  Â  <form id="login-form">
Â  Â  Â  Â  <label style="text-align:left;">Enter Your Name</label>
Â  Â  Â  Â  <input id="username-input" required placeholder="Pearl" />
Â  Â  Â  Â  <button class="btn btn-primary" type="submit">Start Planning</button>
Â  Â  Â  Â  <div style="color:var(--muted);font-size:12px;margin-top:15px;">No password needed. Data is stored locally.</div>
Â  Â  Â  </form>
Â  Â  </div>
Â  </div>

Â  Â  <div class="container" id="app" style="visibility: hidden;">
Â  Â  <header>
Â  Â  Â  <div class="brand">
Â  Â  Â  Â  <div class="logo">SF</div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <h1>StudyFlow â€” Focus Planner</h1>
Â  Â  Â  Â  Â  <div class="subtitle">Spacious layout â€¢ Pomodoro â€¢ Date-specific tasks</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <div style="display:flex;gap:12px;align-items:center;">
Â  Â  Â  Â  <nav class="topnav" id="nav">
Â  Â  Â  Â  Â  <a href="#/" data-route="/" class="active">Dashboard</a>
Â  Â  Â  Â  Â  <a href="#/planner" data-route="/planner">Daily Planner</a>
Â  Â  Â  Â  Â  <a href="#/analytics" data-route="/analytics">Analytics</a>
Â  Â  Â  Â  </nav>
Â  Â  Â  Â  <div style="width:1px;height:36px;background:var(--border);border-radius:2px"></div>
Â  Â  Â  Â  <div style="text-align:right">
Â  Â  Â  Â  Â  <div style="font-size:12px;color:var(--muted)">Signed in as</div>
Â  Â  Â  Â  Â  <div style="font-weight:800" id="header-username">Pearl <span class="badge" style="margin-left:8px">Pro</span></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </header>

Â  Â  <div class="layout" style="margin-top:8px;">
Â  Â  Â  <aside class="side">
Â  Â  Â  Â  <div class="card" style="margin-bottom:12px">
Â  Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <div style="font-size:13px;color:var(--muted)">Welcome</div>
Â  Â  Â  Â  Â  Â  Â  <div style="font-weight:800" id="sidebar-username">Pearl</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="text-align:center;">
Â  Â  Â  Â  Â  Â  Â  <div class="badge">PRO</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card" style="margin-bottom:12px">
Â  Â  Â  Â  Â  <h4 style="margin:0 0 12px 0">Todayâ€™s Quote</h4>
Â  Â  Â  Â  Â  <div id="daily-quote" class="quote">Loading inspirational quote...</div>
Â  Â  Â  Â  Â  <div style="display:flex;gap:8px;">
Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" id="refresh-quote">Refresh</button>
Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="copy-quote">Copy</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card" style="margin-bottom:12px">
Â  Â  Â  Â  Â  <h4 style="margin-bottom:8px">Quick Actions</h4>
Â  Â  Â  Â  Â  <button class="btn btn-primary" id="quick-add-event" style="width:100%;">+ Add Event</button>
Â  Â  Â  Â  Â  <div style="height:10px"></div>
Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="quick-start" style="width:100%;">Start Pomodoro</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  <h4 style="margin-bottom:8px">Mini Calendar</h4>
Â  Â  Â  Â  Â  <div id="side-mini-calendar" class="calendar"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </aside>

Â  Â  Â  <main class="main">
Â  Â  Â  Â  Â  Â  Â  Â  <section id="view-dashboard" class="view">
Â  Â  Â  Â  Â  <div class="card" style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <h2 style="margin:0" id="welcome-message">Welcome back, Pearl</h2>
Â  Â  Â  Â  Â  Â  Â  <div class="subtitle">Focus on today's priorities</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="text-align:right">
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:13px">Productivity Score</div>
Â  Â  Â  Â  Â  Â  Â  <div style="font-weight:800;color:var(--text);font-size:20px" id="overview-productivity">0%</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="card stats-grid" style="margin-top:12px;">
Â  Â  Â  Â  Â  Â  <div class="stat">
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted)">Upcoming Tasks</div>
Â  Â  Â  Â  Â  Â  Â  <div class="big" id="stat-tasks">0</div>
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:12px">events scheduled</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="stat">
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted)">Pomodoro Sessions</div>
Â  Â  Â  Â  Â  Â  Â  <div class="big" id="stat-pomo">0</div>
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:12px">sessions completed this week</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="stat">
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted)">Time Focused</div>
Â  Â  Â  Â  Â  Â  Â  <div class="big" id="stat-minutes">0m</div>
Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:12px">total this week</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div style="display:grid;grid-template-columns:1fr 420px;gap:14px;margin-top:14px;">
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0;">Upcoming Events</h3>
Â  Â  Â  Â  Â  Â  Â  <div id="upcoming-events" class="events-list"></div>
Â  Â  Â  Â  Â  Â  Â  <div id="empty-upcoming" style="color:var(--muted);padding:12px">No upcoming events.</div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0;">Pomodoro Timer</h3>
Â  Â  Â  Â  Â  Â  Â  <div style="padding:18px 0;text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timer-large" id="timer-display">25:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="tm-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" id="tm-start">Start</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="tm-reset">Reset</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:10px;color:var(--muted);font-size:13px">Total sessions: <span id="total-sessions">0</span></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  Â  Â  Â  Â  <section id="view-planner" class="view" style="display:none;">
Â  Â  Â  Â  Â  <div style="display:grid;grid-template-columns:1fr 420px;gap:12px;">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="cal-head">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong id="cal-month-year"></strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:13px">Click any date to add or view events</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="prev-month">&lt;</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="next-month">&gt;</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="calendar" id="calendar-root">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cal-grid" id="calendar-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Mon</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Tue</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Wed</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Thu</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Fri</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Sat</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="weekday-label">Sun</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="selected-date" id="selected-date-label" style="margin-top:12px;color:var(--muted)">Selected: -</div>

Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:12px;" class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="margin:0 0 10px 0">Add Event</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="add-event-form">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Title</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="evt-title" required placeholder="e.g. Study Algorithms" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Time</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="evt-time" type="time" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Description</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="evt-desc" rows="3" placeholder="Short note (optional)"></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" type="submit">Add/Update Event</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" type="button" id="clear-form">Clear Form</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" type="button" id="goto-today">Go to Today</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="margin-top:0">Events for selected date</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="events-for-day" class="events-list"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="no-events-day" style="color:var(--muted);padding:12px">No events for this date.</div>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  <div class="card" style="margin-top:12px;">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="margin-top:0">Mini Pomodoro</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:center;padding:12px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="mini-timer" style="font-weight:800;font-size:20px;color:var(--accent-2)">25:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" id="mini-start">Start</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost" id="mini-reset">Reset</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  Â  Â  Â  Â  <section id="view-analytics" class="view" style="display:none;">
Â  Â  Â  Â  Â  <div class="card chart-wrap">
Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0">Weekly Study Time (minutes)</h3>
Â  Â  Â  Â  Â  Â  <canvas id="chart-line" height="100"></canvas>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="card chart-wrap" style="margin-top:12px;">
Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0">Event & Session Distribution (Last 7 Days)</h3>
Â  Â  Â  Â  Â  Â  <canvas id="chart-donut" height="100"></canvas>
Â  Â  Â  Â  Â  Â  <div style="text-align:center;color:var(--muted);font-size:13px;margin-top:10px;">Planned = Events Scheduled â€¢ Focused = Pomodoro Sessions Completed</div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="card" style="margin-top:12px;">
Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0">Productivity Metrics</h3>
Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:8px">
Â  Â  Â  Â  Â  Â  Â  <div style="flex:1 1 200px;padding:12px;border-radius:8px;background:linear-gradient(90deg, rgba(154,211,199,0.12), rgba(199,210,255,0.06))">Sessions this week: <strong id="stat-week-sessions">0</strong></div>
Â  Â  Â  Â  Â  Â  Â  <div style="flex:1 1 200px;padding:12px;border-radius:8px;background:linear-gradient(90deg, rgba(255,211,193,0.08), rgba(199,210,255,0.04))">Avg focus/day: <strong id="stat-avg-day">0m</strong></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>

Â  Â  Â  Â  <footer>Built with â™¥ â€” Focus on what matters. Data is stored locally in your browser.</footer>
Â  Â  Â  </main>
Â  Â  </div>
Â  </div>

<script>
/* ---------------------------
Â  Constants & Storage Keys
----------------------------*/
const STORE_EVENTS_KEY = 'sf_events_v1';
const STORE_POMO_KEY = 'sf_pomo_v1';
const STORE_MINUTES_KEY = 'sf_weekly_minutes_v1';
const STORE_USER_KEY = 'sf_user_v1';

function loadEvents(){ try{ return JSON.parse(localStorage.getItem(STORE_EVENTS_KEY) || '[]'); }catch(e){return []} }
function saveEvents(events){ localStorage.setItem(STORE_EVENTS_KEY, JSON.stringify(events)); }
function loadPomo(){ try{ return JSON.parse(localStorage.getItem(STORE_POMO_KEY) || '{}'); }catch(e){return {} } }
function savePomo(state){ localStorage.setItem(STORE_POMO_KEY, JSON.stringify(state)); }
function loadUser(){ return localStorage.getItem(STORE_USER_KEY); }
function saveUser(name){ localStorage.setItem(STORE_USER_KEY, name); }


/* ---------------------------
Â  Authentication / Initial Load
----------------------------*/
document.getElementById('login-form').addEventListener('submit', (e) => {
Â  e.preventDefault();
Â  const username = document.getElementById('username-input').value.trim();
Â  if (username) {
Â  Â  saveUser(username);
Â  Â  initApp(username);
Â  }
});

function initApp(username) {
Â  // Update all username placeholders
Â  const capitalizedUsername = username.charAt(0).toUpperCase() + username.slice(1);
Â  document.getElementById('header-username').innerHTML = capitalizedUsername + ' <span class="badge" style="margin-left:8px">Pro</span>';
Â  document.getElementById('sidebar-username').textContent = capitalizedUsername;
Â  document.getElementById('welcome-message').textContent = `Welcome back, ${capitalizedUsername}`;

Â  // Hide login and show main app
Â  document.getElementById('login-view').style.display = 'none';
Â  document.getElementById('app').style.visibility = 'visible';

Â  // Initialize main components
Â  onHashChange();
Â  fetchQuote();
Â  renderCalendar();
Â  renderEventsForDay();
Â  refreshOverview();
Â  initCharts();
}

// Check for existing user on load
const storedUser = loadUser();
if (storedUser) {
Â  initApp(storedUser);
} else {
Â  document.getElementById('app').style.visibility = 'hidden';
}

/* ---------------------------
Â  Simple SPA routing (hash)
----------------------------*/
function setActiveRoute(path){
Â  document.querySelectorAll('#nav a').forEach(a=>{
Â  Â  a.classList.toggle('active', a.getAttribute('href') === '#'+path);
Â  });
Â  document.querySelectorAll('.view').forEach(v=> v.style.display='none');
Â  if(path === '/') document.getElementById('view-dashboard').style.display='block';
Â  if(path === '/planner') document.getElementById('view-planner').style.display='block';
Â  if(path === '/analytics') document.getElementById('view-analytics').style.display='block';
Â  // Ensure charts update when entering the analytics view
Â  if(path === '/analytics') updateCharts();
}
function onHashChange(){
Â  const path = location.hash.replace('#','') || '/';
Â  setActiveRoute(path);
}
window.addEventListener('hashchange', onHashChange);

/* ---------------------------
Â  Date Utilities
----------------------------*/
let today = new Date();
let viewYear = today.getFullYear();
let viewMonth = today.getMonth(); // 0-index
let selectedDate = formatDateISO(today);

function formatDateISO(d){ // accept Date or string
Â  const D = (typeof d === 'string')? new Date(d): d;
Â  const y = D.getFullYear(), m = String(D.getMonth()+1).padStart(2,'0'), dt = String(D.getDate()).padStart(2,'0');
Â  return y+'-'+m+'-'+dt;
}
function startOfDay(d){ const x = new Date(d); x.setHours(0,0,0,0); return x; }

/* ---------------------------
Â  Calendar rendering (FIXED: Monday Start)
----------------------------*/
const calendarGrid = document.getElementById('calendar-grid');
const calMonthYear = document.getElementById('cal-month-year');
const selectedLabel = document.getElementById('selected-date-label');

function renderCalendar(){
Â  // Clear existing days, keep weekday headers
Â  while (calendarGrid.children.length > 7) {
Â  Â  calendarGrid.removeChild(calendarGrid.lastChild);
Â  }

Â  calMonthYear.textContent = new Date(viewYear, viewMonth).toLocaleString(undefined,{month:'long',year:'numeric'});
Â  const first = new Date(viewYear, viewMonth, 1);
Â  // Calculate start day (0=Mon, 6=Sun) - FIX: (getDay() + 6) % 7 converts Sun=0 to Mon=6
Â  const startDay = (first.getDay() === 0) ? 6 : first.getDay() - 1; 
Â  const daysInMonth = new Date(viewYear, viewMonth + 1, 0).getDate();
Â  const events = loadEvents();

Â  // Fill empty slots
Â  for(let i = 0; i < startDay; i++){
Â  Â  const el = document.createElement('div'); el.className='day dimmed'; el.textContent=''; calendarGrid.appendChild(el);
Â  }

Â  // Render days
Â  for(let d = 1; d <= daysInMonth; d++){
Â  Â  const dt = new Date(viewYear, viewMonth, d);
Â  Â  const iso = formatDateISO(dt);
Â  Â  const el = document.createElement('div');
Â  Â  el.className='day';
Â  Â  el.textContent=d;
Â  Â  
Â  Â  if(formatDateISO(today) === iso) el.classList.add('today');
Â  Â  if(events.some(e=> e.date===iso)) el.classList.add('has-event');
Â  Â  if(selectedDate === iso) el.classList.add('selected-outline');
Â  Â  
Â  Â  el.addEventListener('click', ()=>{ 
Â  Â  Â  selectedDate = iso; 
Â  Â  Â  selectedLabel.textContent = 'Selected: '+iso; 
Â  Â  Â  renderEventsForDay(); 
Â  Â  Â  renderCalendar(); // Re-render to update selected outline
Â  Â  Â  location.hash='/planner'; 
Â  Â  });
Â  Â  calendarGrid.appendChild(el);
Â  }
}

document.getElementById('prev-month').addEventListener('click', ()=>{ viewMonth--; if(viewMonth<0){viewMonth=11; viewYear--} renderCalendar();});
document.getElementById('next-month').addEventListener('click', ()=>{ viewMonth++; if(viewMonth>11){viewMonth=0; viewYear++} renderCalendar();});
document.getElementById('goto-today').addEventListener('click', ()=>{ viewMonth = today.getMonth(); viewYear = today.getFullYear(); selectedDate = formatDateISO(today); selectedLabel.textContent = 'Selected: ' + selectedDate; renderCalendar(); renderEventsForDay(); });

selectedLabel.textContent = 'Selected: '+selectedDate;

/* ---------------------------
Â  Events UI
----------------------------*/
const addForm = document.getElementById('add-event-form');
addForm.addEventListener('submit', (e)=>{
Â  e.preventDefault();
Â  const title = document.getElementById('evt-title').value.trim();
Â  const time = document.getElementById('evt-time').value;
Â  const desc = document.getElementById('evt-desc').value.trim();
Â  if(!title) return alert('Please add a title');
Â  let events = loadEvents();

Â  // Check if the form is being used for editing (if an event was removed before form fill)
Â  // For simplicity, we assume 'edit' means pre-filling and then submitting a new event after deleting the old one (see edit-btn logic)
Â  // Otherwise, this always adds a new event.
Â  
Â  events.push({id:Date.now(), date:selectedDate, title, time, desc});
Â  saveEvents(events);
Â  addForm.reset();
Â  renderCalendar();
Â  renderEventsForDay();
Â  refreshOverview();
});
document.getElementById('clear-form').addEventListener('click', ()=> addForm.reset());

function renderEventsForDay(){
Â  const list = document.getElementById('events-for-day');
Â  const noEv = document.getElementById('no-events-day');
Â  list.innerHTML = '';
Â  const events = loadEvents().filter(ev=> ev.date === selectedDate).sort((a,b)=> (a.time||'') > (b.time||'')?1:-1);
Â  if(events.length===0){ noEv.style.display='block'; } else { noEv.style.display='none'; }
Â  events.forEach(ev=>{
Â  Â  const el = document.createElement('div'); el.className='event';
Â  Â  el.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex:1;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-weight:800">${escapeHtml(ev.title)}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:13px;margin-top:6px">${ev.time || 'All Day'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${ev.desc?'<div style="color:var(--muted);font-size:13px;margin-top:8px">'+escapeHtml(ev.desc)+'</div>':''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="trash" data-id="${ev.id}" title="Delete">ðŸ—‘</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-ghost edit-btn" data-id="${ev.id}" style="padding:6px 8px;font-weight:600">Edit</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  list.appendChild(el);
Â  });
Â  // delete handlers
Â  list.querySelectorAll('.trash').forEach(btn=>{
Â  Â  btn.addEventListener('click', ()=>{
Â  Â  Â  const id = Number(btn.dataset.id);
Â  Â  Â  const all = loadEvents().filter(x=> x.id !== id);
Â  Â  Â  saveEvents(all);
Â  Â  Â  renderCalendar(); renderEventsForDay(); refreshOverview();
Â  Â  });
Â  });
Â  // edit handlers (simple inline edit: delete old, pre-fill form for new)
Â  list.querySelectorAll('.edit-btn').forEach(btn=>{
Â  Â  btn.addEventListener('click', ()=>{
Â  Â  Â  const id = Number(btn.dataset.id);
Â  Â  Â  const ev = loadEvents().find(x=> x.id === id);
Â  Â  Â  if(!ev) return;
Â  Â  Â  // 1. Populate form
Â  Â  Â  document.getElementById('evt-title').value = ev.title;
Â  Â  Â  document.getElementById('evt-time').value = ev.time || '';
Â  Â  Â  document.getElementById('evt-desc').value = ev.desc || '';
Â  Â  Â  // 2. Remove existing event (so form submission creates an updated one)
Â  Â  Â  const remaining = loadEvents().filter(x=> x.id !== id);
Â  Â  Â  saveEvents(remaining);
Â  Â  Â  renderCalendar(); // update mark on calendar
Â  Â  Â  renderEventsForDay(); // update day list
Â  Â  Â  refreshOverview();
Â  Â  Â  document.getElementById('evt-title').focus();
Â  Â  });
Â  });
Â  renderUpcoming();
}

function renderUpcoming(){
Â  const up = document.getElementById('upcoming-events');
Â  const empty = document.getElementById('empty-upcoming');
Â  up.innerHTML='';
Â  // Filter for upcoming events, sort by date/time
Â  const now = new Date();
Â  const events = loadEvents().filter(e=> {
Â  Â  const eventDate = new Date(e.date + (e.time ? `T${e.time}:00` : 'T00:00:00'));
Â  Â  return eventDate >= now;
Â  }).sort((a,b)=> {
Â  Â  const dateA = new Date(a.date + (a.time ? `T${a.time}:00` : 'T00:00:00'));
Â  Â  const dateB = new Date(b.date + (b.time ? `T${b.time}:00` : 'T00:00:00'));
Â  Â  return dateA - dateB;
Â  });
Â  
Â  if(events.length===0){ empty.style.display='block'; } else { empty.style.display='none'; }
Â  events.slice(0,6).forEach(ev=>{
Â  Â  const el = document.createElement('div'); el.className='event';
Â  Â  el.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-weight:800">${escapeHtml(ev.title)}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="color:var(--muted);font-size:13px">${ev.date} ${ev.time || 'All Day'}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="trash" data-id="${ev.id}" title="Delete">ðŸ—‘</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  up.appendChild(el);
Â  });
Â  // delete handlers in upcoming
Â  up.querySelectorAll('.trash').forEach(btn=>{
Â  Â  btn.addEventListener('click', ()=>{
Â  Â  Â  const id = Number(btn.dataset.id);
Â  Â  Â  const all = loadEvents().filter(x=> x.id !== id);
Â  Â  Â  saveEvents(all);
Â  Â  Â  renderCalendar(); renderEventsForDay(); refreshOverview();
Â  Â  });
Â  });
}

/* quick add */
document.getElementById('quick-add-event').addEventListener('click', ()=>{
Â  location.hash = '/planner';
Â  selectedDate = formatDateISO(new Date());
Â  selectedLabel.textContent = 'Selected: ' + selectedDate;
Â  renderEventsForDay();
Â  renderCalendar();
Â  setTimeout(()=> document.getElementById('evt-title').focus(), 200);
});

/* ---------------------------
Â  Pomodoro timer (global + mini)
----------------------------*/
const TM_DEFAULT = {minutes:25, seconds:0, running:false, sessions: 0, sessions_week: 0, last_week_reset: formatDateISO(new Date())};
let pomState = {...TM_DEFAULT, ...loadPomo()};

// Weekly reset logic (Fix: ensures weekly session count is accurate)
function checkWeeklyReset(){
Â  const todayKey = formatDateISO(new Date());
Â  const lastReset = pomState.last_week_reset;
Â  const dToday = new Date(todayKey);
Â  const dLast = new Date(lastReset);
Â  // Find the start of the current week (Monday)
Â  const currentWeekStart = new Date(dToday);
Â  currentWeekStart.setDate(dToday.getDate() - (dToday.getDay() === 0 ? 6 : dToday.getDay() - 1));
Â  
Â  // Check if the last reset was before the start of the current week
Â  if (dLast < startOfDay(currentWeekStart)) {
Â  Â  pomState.sessions_week = 0;
Â  Â  pomState.last_week_reset = todayKey;
Â  Â  savePomo(pomState);
Â  }
}
checkWeeklyReset();

updateTimerUI();

let timerInterval = null;
function startTimer(isMini=false){
Â  if(pomState.running) return;
Â  
Â  pomState.running = true;
Â  pomState.lastStarted = Date.now();
Â  savePomo(pomState);
Â  
Â  updateTimerUI(isMini);
Â  
Â  timerInterval = setInterval(()=> {
Â  Â  if(pomState.seconds === 0){
Â  Â  Â  if(pomState.minutes === 0){
Â  Â  Â  Â  // SESSION COMPLETE
Â  Â  Â  Â  pomState.running = false;
Â  Â  Â  Â  pomState.sessions = (pomState.sessions || 0) + 1; // total sessions
Â  Â  Â  Â  pomState.sessions_week = (pomState.sessions_week || 0) + 1; // weekly sessions
Â  Â  Â  Â  addStudyMinutesForToday(25);
Â  Â  Â  Â  clearInterval(timerInterval);
Â  Â  Â  Â  timerInterval = null;
Â  Â  Â  Â  pomState.minutes = 25; pomState.seconds = 0;
Â  Â  Â  Â  savePomo(pomState);
Â  Â  Â  Â  refreshOverview();
Â  Â  Â  Â  updateTimerUI();
Â  Â  Â  Â  // small notification
Â  Â  Â  Â  try{ new Notification && new Notification('Pomodoro complete! Time for a break.'); }catch(e){}
Â  Â  Â  Â  return;
Â  Â  Â  } else {
Â  Â  Â  Â  pomState.minutes -= 1;
Â  Â  Â  Â  pomState.seconds = 59;
Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  pomState.seconds -= 1;
Â  Â  }
Â  Â  savePomo(pomState);
Â  Â  updateTimerUI();
Â  }, 1000);
}
function resetTimer(){
Â  pomState.running = false;
Â  pomState.minutes = 25; pomState.seconds = 0;
Â  savePomo(pomState);
Â  if(timerInterval) clearInterval(timerInterval);
Â  timerInterval = null;
Â  updateTimerUI();
}
function updateTimerUI(){
Â  const mm = String(pomState.minutes).padStart(2,'0');
Â  const ss = String(pomState.seconds).padStart(2,'0');
Â  document.getElementById('timer-display').textContent = mm+':'+ss;
Â  document.getElementById('total-sessions').textContent = pomState.sessions || 0;
Â  // Update both stats fields
Â  document.getElementById('stat-pomo').textContent = pomState.sessions_week || 0;
Â  document.getElementById('stat-week-sessions').textContent = pomState.sessions_week || 0;
Â  document.getElementById('mini-timer').textContent = mm+':'+ss;
}
document.getElementById('tm-start').addEventListener('click', ()=> { startTimer(); });
document.getElementById('tm-reset').addEventListener('click', ()=> { resetTimer(); });

/* mini timer (uses main timer state) */
document.getElementById('mini-start').addEventListener('click', ()=> { startTimer(true); });
document.getElementById('mini-reset').addEventListener('click', ()=> { resetTimer(); });
document.getElementById('quick-start').addEventListener('click', ()=>{ startTimer(); location.hash='/planner'; });

/* ---------------------------
Â  Weekly minutes (analytics)
----------------------------*/
function addStudyMinutesForToday(mins){
Â  const raw = JSON.parse(localStorage.getItem(STORE_MINUTES_KEY) || '{}');
Â  const todayKey = formatDateISO(new Date());
Â  raw[todayKey] = (raw[todayKey]||0) + (mins||0);
Â  localStorage.setItem(STORE_MINUTES_KEY, JSON.stringify(raw));
Â  updateCharts();
}
function getWeeklyMinutes(){
Â  const raw = JSON.parse(localStorage.getItem(STORE_MINUTES_KEY) || '{}');
Â  const out = [];
Â  const now = new Date();
Â  
Â  for(let i=6;i>=0;i--){
Â  Â  const d = new Date(now); d.setDate(now.getDate() - i);
Â  Â  const k = formatDateISO(d);
Â  Â  out.push({date:k, minutes: raw[k] || 0});
Â  }
Â  return out;
}

/* ---------------------------
Â  Charts (Chart.js) - FIXED: Improved logic & labels
----------------------------*/
let lineChart = null, donutChart = null;
function initCharts(){
Â  const ctxLine = document.getElementById('chart-line').getContext('2d');
Â  const ctxDonut = document.getElementById('chart-donut').getContext('2d');
Â  
Â  // Line Chart
Â  lineChart = new Chart(ctxLine, {
Â  Â  type:'line',
Â  Â  data:{labels:[],datasets:[{label:'Minutes',data:[],tension:0.3,fill:true,backgroundColor:'rgba(154,211,199,0.25)',borderColor:'rgba(154,211,199,0.9)',pointRadius:4}]},
Â  Â  options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true, title:{display:true, text:'Minutes'}}}}
Â  });
Â  
Â  // Doughnut Chart (FIXED: Comparison between scheduled events and completed sessions)
Â  donutChart = new Chart(ctxDonut, {
Â  Â  type:'doughnut',
Â  Â  data:{labels:['Planned Events','Focused Sessions'],datasets:[{data:[0,1],backgroundColor:['rgba(199,210,255,0.9)','rgba(255,213,182,0.9)']}]},
Â  Â  options:{
Â  Â  Â  plugins:{
Â  Â  Â  Â  legend:{position:'bottom'},
Â  Â  Â  Â  tooltip: {
Â  Â  Â  Â  Â  callbacks: {
Â  Â  Â  Â  Â  Â  label: function(context) {
Â  Â  Â  Â  Â  Â  Â  let label = context.label || '';
Â  Â  Â  Â  Â  Â  Â  if (label) { label += ': ';}
Â  Â  Â  Â  Â  Â  Â  label += context.raw;
Â  Â  Â  Â  Â  Â  Â  return label;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  });
Â  updateCharts();
}

function updateCharts(){
Â  const wk = getWeeklyMinutes();
Â  
Â  // 1. Line Chart Data
Â  const labels = wk.map(x=> new Date(x.date).toLocaleDateString(undefined,{weekday:'short'}));
Â  const data = wk.map(x=> x.minutes);
Â  if(lineChart){
Â  Â  lineChart.data.labels = labels;
Â  Â  lineChart.data.datasets[0].data = data;
Â  Â  lineChart.update();
Â  }
Â  
Â  // 2. Donut Chart Data (FIXED: Using counts for meaningful comparison)
Â  const events = loadEvents();
Â  const weekStart = startOfDay(new Date(new Date().setDate(new Date().getDate()-6)));
Â  // Count scheduled events this week (or since start of week for better relevance)
Â  const plannedEvents = events.filter(e=> new Date(e.date) >= weekStart).length;
Â  // Count completed Pomodoro sessions this week (already tracked in pomState.sessions_week)
Â  const focusedSessions = pomState.sessions_week || 0;
Â  
Â  if(donutChart){
Â  Â  // Ensure a total of at least 1 for the chart to render
Â  Â  const total = plannedEvents + focusedSessions;
Â  Â  donutChart.data.datasets[0].data = [plannedEvents, focusedSessions];
Â  Â  donutChart.update();
Â  }
Â  
Â  // 3. Update Quick Stats
Â  const minutesTotal = wk.reduce((a,b)=>a+b.minutes,0);
Â  document.getElementById('stat-minutes').textContent = minutesTotal + 'm';
Â  document.getElementById('stat-week-sessions').textContent = focusedSessions;
Â  document.getElementById('stat-avg-day').textContent = Math.round(minutesTotal/7) + 'm';
}

/* ---------------------------
Â  Overview refresh (counts)
----------------------------*/
function refreshOverview(){
Â  const events = loadEvents();
Â  // Upcoming tasks (total events in the future)
Â  const upcomingTasks = events.filter(e => new Date(e.date + (e.time ? `T${e.time}:00` : 'T00:00:00')) >= new Date()).length;
Â  document.getElementById('stat-tasks').textContent = upcomingTasks;
Â  document.getElementById('stat-pomo').textContent = pomState.sessions_week || 0;
Â  updateTimerUI();
Â  
Â  // Productivity: Ratio of sessions to upcoming tasks (simple metric)
Â  const productivity = Math.round(((pomState.sessions_week || 0) / (upcomingTasks > 0 ? upcomingTasks : 1)) * 100);
Â  document.getElementById('overview-productivity').textContent = Math.min(100, productivity) + '%';
Â  
Â  renderUpcoming();
Â  updateCharts();
}

/* ---------------------------
Â  Utility helpers
----------------------------*/
function escapeHtml(s){ return String(s || '').replace(/[&<>"']/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]) ); }

/* ---------------------------
Â  Daily quote (fetch API)
----------------------------*/
const QUOTE_EL = document.getElementById('daily-quote');
async function fetchQuote(){
Â  const fallback = {content: "Keep going â€” progress is progress, no matter how small.", author: "Unknown"};
Â  try{
Â  Â  const res = await fetch('https://api.quotable.io/random?tags=technology|inspirational|wisdom');
Â  Â  if(!res.ok) throw new Error('quote fetch failed');
Â  Â  const data = await res.json();
Â  Â  QUOTE_EL.textContent = `â€œ${data.content}â€ â€” ${data.author || 'Unknown'}`;
Â  } catch(e){
Â  Â  QUOTE_EL.textContent = `â€œ${fallback.content}â€ â€” ${fallback.author}`;
Â  }
}
document.getElementById('refresh-quote').addEventListener('click', fetchQuote);
document.getElementById('copy-quote').addEventListener('click', ()=>{
Â  const quote = QUOTE_EL.textContent.replace(/[â€œâ€]/g, '').trim();
Â  navigator.clipboard.writeText(quote)
Â  Â  .then(() => alert('Quote copied to clipboard!'))
Â  Â  .catch(err => console.error('Could not copy text: ', err));
});
</script>
</body>
</html>
